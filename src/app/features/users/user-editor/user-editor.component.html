<div class="container mx-auto p-4 animate-soft-in">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-black text-[rgb(var(--color-primary))] uppercase tracking-tighter">
      {{ isEditMode ? i18nService.translate('COMMON.EDIT') : i18nService.translate('COMMON.CREATE') }} {{ i18nService.translate('SIDEBAR.USERS').slice(0, -1) }}
    </h1>
    <a routerLink="/users" class="button-secondary">
      &larr; {{ i18nService.translate('COMMON.BACK_TO_LIST') }}
    </a>
  </div>

  <form [formGroup]="editorForm" (ngSubmit)="onSubmit()" class="card-soft p-8 max-w-2xl mx-auto space-y-8">

    <!-- Main Details -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div>
        <label for="username" class="label">{{ i18nService.translate('LOGIN.USERNAME') }}</label>
        <input formControlName="username" id="username" type="text" class="input" [class.opacity-50]="isEditMode">
      </div>
      <div>
        <label for="email" class="label">Email</label>
        <input formControlName="email" id="email" type="email" class="input">
      </div>
    </div>

    <!-- Status -->
    @if (isEditMode) {
      <div class="p-4 bg-white/5 rounded-2xl border border-white/5">
        <label class="label">{{ i18nService.translate('COMMON.STATUS') }}</label>
        <div class="flex items-center h-10">
          <input formControlName="enabled" id="status-enabled" type="checkbox" class="h-6 w-6 rounded-xl border-none bg-white/5 text-[rgb(var(--color-primary))] focus:ring-offset-0 focus:ring-[rgb(var(--color-primary))] cursor-pointer">
          <label for="status-enabled" class="ml-3 text-sm text-gray-400 font-bold">{{ i18nService.translate('COMMON.ACTIVE') }}</label>
        </div>
      </div>
    }

    <!-- Groups -->
    <div class="p-4 bg-white/5 rounded-2xl border border-white/5">
      <h3 class="label text-[rgb(var(--color-primary))] uppercase tracking-widest">{{ i18nService.translate('SIDEBAR.GROUPS') }}</h3>
      <div formGroupName="groups" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
        @for (group of allGroups; track group.id) {
          <div class="flex items-center">
            <input [formControlName]="group.id" [id]="'group-' + group.id" type="checkbox" class="h-5 w-5 rounded-lg border-none bg-white/10 text-[rgb(var(--color-primary))] focus:ring-offset-0 focus:ring-[rgb(var(--color-primary))] cursor-pointer">
            <label [for]="'group-' + group.id" class="ml-3 text-sm text-gray-400 font-medium">{{ group.name }}</label>
          </div>
        }
      </div>
    </div>

    <!-- Form Actions -->
    <div class="flex justify-end space-x-4 border-t border-white/5 pt-8">
      <a routerLink="/users" class="button-secondary px-8">{{ i18nService.translate('COMMON.CANCEL_SHORT') }}</a>
      <button type="submit" [disabled]="editorForm.invalid" class="button-primary px-10">
        {{ isEditMode ? i18nService.translate('COMMON.SAVE') : i18nService.translate('COMMON.CREATE') }}
      </button>
    </div>
  </form>
</div>
